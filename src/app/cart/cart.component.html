<div *ngIf="viewCart" class="overlay" (click)="overlayClick($event)">
  <section class="cart">
    <div class="top">
      <p>Shopping Cart</p>

      <button 
        (click)="onClose()" 
        type="button" class="close-btn" title="Close">
        <i class="material-icons">close</i>
      </button>
    </div>

    <div 
      *ngIf="!cartItems?.length && !isLoading;" 
      class="empty-cart-msg">
      <h3>Your cart is empty</h3>
    </div>

    <div 
      *ngIf="cartItems?.length && !isLoading;" 
      class="content">
      <ul #itemList class="item-list">
        <li *ngFor="let item of cartItems">
          <div *ngIf="item.productImage" class="product-image">
            <img image-loader [src]="item.productImage" [alt]="item.productName">
          </div>

          <div class="product-info">
            <a href="#" class="product-name">
              {{ item.productName | textClip:80 }}
            </a>  
    
            <p class="price">{{ item.price | currency }}</p>

            <div class="options">
              <label for="quantity">
                Quantity: 
                <input 
                  (change)="quantityChanges(item.productId, +$event.target.value)"
                  [value]="item.quantity"
                  name="quantity"
                  id="quantity"
                  type="number" min="1" [max]="item.totalStock">
              </label>

              <button 
                (click)="onRemove(item.productId)"
                class="remove-btn">Remove</button>
            </div>

            <div *ngIf="item.quantity > 1" class="subtotal">
              <p>
                Subtotal (<span>{{ item.quantity }} items</span>):
                <span class="price">
                  {{ item.subtotal | currency }}
                </span>
              </p>
            </div>
          </div>
        </li>
      </ul>
    </div>

    <div *ngIf="cartItems?.length && !isLoading" class="bottom">
      <div class="subtotal">
        <span class="subtotal-items">Items: <strong>{{ itemCount | number }}</strong></span>
        <span class="subtotal-amount">Order Total: <strong>{{ subtotal | currency }}</strong></span>
      </div>

      <button>Proceed to Checkout</button>
    </div>

    <app-spinner [loading]="isLoading"></app-spinner>
  </section>
</div>
